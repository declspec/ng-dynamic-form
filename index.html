<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Test Dynamic Forms</title>

        <link href="//global.curtin.edu.au/template/css/layoutv3.css" rel="stylesheet" type="text/css" />
        <link href="//global.curtin.edu.au/template/css/contentv3.css" rel="stylesheet" type="text/css" />
        <link href="//global.curtin.edu.au/template/css/print.css" rel="stylesheet" type="text/css" media="print" />
        <link href="https://global.curtin.edu.au/flow/forms-2.0.1/css/forms.css" rel="stylesheet" type="text/css" />

        <style>
            .has-error { border: 1px solid red; display: block }
        </style>

        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular.js"></script>
        <script type="text/javascript" src="bin/ng-dynamic-form-0.1.0.js"></script>
        <script type="text/javascript">
            angular.module('ng-dynamic-form').controller('TestController', [ '$scope', 'FormBuilder', function($scope, formBuilder) {
                $scope.form = formBuilder.build();

                $scope.submit = function() {
                    $scope.form.validate().then(function(valid) {
                        if (valid) {
                            alert('valid');
                        }
                    });
                };

                $scope.items = [
                    { id: 'item1', name: 'Item 1' },
                    { id: 'item2', name: 'Item 2' }
                ];
            }]);
        </script>
    </head>
    <!-- TODO: figure out an elegant way to handle chained conditions when the topmost condition changes -->

    <body ng-app="ng-dynamic-form" ng-controller="TestController" id="content">
        <div ng-if="form.validating">I am validating</div>

        <form dynamic-form form="form" class="flow" ng-submit="submit()">
            <fieldset>
                <legend>Dummy Form</legend>

                <form-field-input name="name" type="text" validators="['required']">
                    <p class="hint plain bold">Text entered into this field is automatically 
                        inserted into communication with the student. 
                        Please be mindful of the language used as the 
                        <strong>student(s) will see this text.</strong>
                    </p>
                </form-field-input>

                <form-field-input name="bar" type="text" condition="[check].matches(['item1','item2'])"></form-field-input>
                <form-field-select name="item" items="items" condition="![bar].empty()"></form-field-select>
                <form-field-checklist name="check" items="items"></form-field-checklist>
                <form-field-radiolist name="radio" items="items"></form-field-radiolist>
                <form-field-textarea name="area"></form-field-textarea>

                <form-field-readonly name="bar" condition="![bar].empty()"></form-field-readonly>

                <div>{{state|json}}</div>
                <button type="submit">Go</button>
            </fieldset>
        </form>
    </body>
</html>